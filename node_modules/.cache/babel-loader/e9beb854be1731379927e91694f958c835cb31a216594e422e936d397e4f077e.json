{"ast":null,"code":"import { ClassicPreset as Classic, NodeEditor } from 'rete';\nimport { AreaPlugin } from 'rete-area-plugin';\nimport { ReactPlugin, Presets as ReactPresets } from 'rete-react-plugin';\nimport { createRoot } from 'react-dom/client';\nclass Node extends Classic.Node {\n  constructor() {\n    super('Perf');\n    this.addInput('port', new Classic.Input(socket, 'Input'));\n    this.addOutput('port', new Classic.Output(socket, 'Output'));\n  }\n}\nclass Connection extends Classic.Connection {}\nconst socket = new Classic.Socket('socket');\nexport async function createEditor(container) {\n  const editor = new NodeEditor();\n  const area = new AreaPlugin(container);\n  const reactRender = new ReactPlugin({\n    createRoot\n  });\n  editor.use(area);\n  area.use(reactRender);\n  reactRender.addPreset(ReactPresets.classic.setup());\n\n  // eslint-disable-next-line no-restricted-globals\n  const query = new URLSearchParams(location.search);\n  const rows = Number(query.get('rows') || 0) || 12;\n  const cols = Number(query.get('cols') || 0) || 12;\n  let prev = null;\n  for (let row = 0; row < rows; row++) {\n    for (let col = 0; col < cols; col++) {\n      const a = new Node();\n      await editor.addNode(a);\n      await area.translate(a.id, {\n        x: col * 310,\n        y: row * 190\n      });\n      if (prev) {\n        await editor.addConnection(new Connection(prev, 'port', a, 'port'));\n      }\n      prev = a;\n    }\n  }\n  return {\n    destroy: () => area.destroy()\n  };\n}","map":{"version":3,"names":["ClassicPreset","Classic","NodeEditor","AreaPlugin","ReactPlugin","Presets","ReactPresets","createRoot","Node","constructor","addInput","Input","socket","addOutput","Output","Connection","Socket","createEditor","container","editor","area","reactRender","use","addPreset","classic","setup","query","URLSearchParams","location","search","rows","Number","get","cols","prev","row","col","a","addNode","translate","id","x","y","addConnection","destroy"],"sources":["/Users/jolu/Documents/code/jira-node-editor/src/rete/perf.ts"],"sourcesContent":["import { ClassicPreset as Classic, GetSchemes, NodeEditor } from 'rete';\nimport { AreaPlugin } from 'rete-area-plugin';\n\nimport {\n  ReactPlugin,\n  ReactArea2D,\n  Presets as ReactPresets,\n} from 'rete-react-plugin';\nimport { createRoot } from 'react-dom/client';\n\nclass Node extends Classic.Node {\n  constructor() {\n    super('Perf');\n\n    this.addInput('port', new Classic.Input(socket, 'Input'));\n    this.addOutput('port', new Classic.Output(socket, 'Output'));\n  }\n}\n\nclass Connection<A extends Node, B extends Node> extends Classic.Connection<\n  A,\n  B\n> {}\n\ntype Schemes = GetSchemes<Node, Connection<Node, Node>>;\n\ntype AreaExtra = ReactArea2D<Schemes>;\n\nconst socket = new Classic.Socket('socket');\n\nexport async function createEditor(container: HTMLElement) {\n  const editor = new NodeEditor<Schemes>();\n  const area = new AreaPlugin<Schemes, AreaExtra>(container);\n  const reactRender = new ReactPlugin<Schemes, AreaExtra>({ createRoot });\n\n  editor.use(area);\n\n  area.use(reactRender);\n\n  reactRender.addPreset(ReactPresets.classic.setup());\n\n  // eslint-disable-next-line no-restricted-globals\n  const query = new URLSearchParams(location.search);\n  const rows = Number(query.get('rows') || 0) || 12;\n  const cols = Number(query.get('cols') || 0) || 12;\n\n  let prev: null | Node = null;\n  for (let row = 0; row < rows; row++) {\n    for (let col = 0; col < cols; col++) {\n      const a = new Node();\n\n      await editor.addNode(a);\n      await area.translate(a.id, { x: col * 310, y: row * 190 });\n\n      if (prev) {\n        await editor.addConnection(new Connection(prev, 'port', a, 'port'));\n      }\n      prev = a;\n    }\n  }\n\n  return {\n    destroy: () => area.destroy(),\n  };\n}\n"],"mappings":"AAAA,SAASA,aAAa,IAAIC,OAAO,EAAcC,UAAU,QAAQ,MAAM;AACvE,SAASC,UAAU,QAAQ,kBAAkB;AAE7C,SACEC,WAAW,EAEXC,OAAO,IAAIC,YAAY,QAClB,mBAAmB;AAC1B,SAASC,UAAU,QAAQ,kBAAkB;AAE7C,MAAMC,IAAI,SAASP,OAAO,CAACO,IAAI,CAAC;EAC9BC,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,MAAM,CAAC;IAEb,IAAI,CAACC,QAAQ,CAAC,MAAM,EAAE,IAAIT,OAAO,CAACU,KAAK,CAACC,MAAM,EAAE,OAAO,CAAC,CAAC;IACzD,IAAI,CAACC,SAAS,CAAC,MAAM,EAAE,IAAIZ,OAAO,CAACa,MAAM,CAACF,MAAM,EAAE,QAAQ,CAAC,CAAC;EAC9D;AACF;AAEA,MAAMG,UAAU,SAAyCd,OAAO,CAACc,UAAU,CAGzE;AAMF,MAAMH,MAAM,GAAG,IAAIX,OAAO,CAACe,MAAM,CAAC,QAAQ,CAAC;AAE3C,OAAO,eAAeC,YAAYA,CAACC,SAAsB,EAAE;EACzD,MAAMC,MAAM,GAAG,IAAIjB,UAAU,CAAU,CAAC;EACxC,MAAMkB,IAAI,GAAG,IAAIjB,UAAU,CAAqBe,SAAS,CAAC;EAC1D,MAAMG,WAAW,GAAG,IAAIjB,WAAW,CAAqB;IAAEG;EAAW,CAAC,CAAC;EAEvEY,MAAM,CAACG,GAAG,CAACF,IAAI,CAAC;EAEhBA,IAAI,CAACE,GAAG,CAACD,WAAW,CAAC;EAErBA,WAAW,CAACE,SAAS,CAACjB,YAAY,CAACkB,OAAO,CAACC,KAAK,CAAC,CAAC,CAAC;;EAEnD;EACA,MAAMC,KAAK,GAAG,IAAIC,eAAe,CAACC,QAAQ,CAACC,MAAM,CAAC;EAClD,MAAMC,IAAI,GAAGC,MAAM,CAACL,KAAK,CAACM,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE;EACjD,MAAMC,IAAI,GAAGF,MAAM,CAACL,KAAK,CAACM,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE;EAEjD,IAAIE,IAAiB,GAAG,IAAI;EAC5B,KAAK,IAAIC,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAGL,IAAI,EAAEK,GAAG,EAAE,EAAE;IACnC,KAAK,IAAIC,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAGH,IAAI,EAAEG,GAAG,EAAE,EAAE;MACnC,MAAMC,CAAC,GAAG,IAAI7B,IAAI,CAAC,CAAC;MAEpB,MAAMW,MAAM,CAACmB,OAAO,CAACD,CAAC,CAAC;MACvB,MAAMjB,IAAI,CAACmB,SAAS,CAACF,CAAC,CAACG,EAAE,EAAE;QAAEC,CAAC,EAAEL,GAAG,GAAG,GAAG;QAAEM,CAAC,EAAEP,GAAG,GAAG;MAAI,CAAC,CAAC;MAE1D,IAAID,IAAI,EAAE;QACR,MAAMf,MAAM,CAACwB,aAAa,CAAC,IAAI5B,UAAU,CAACmB,IAAI,EAAE,MAAM,EAAEG,CAAC,EAAE,MAAM,CAAC,CAAC;MACrE;MACAH,IAAI,GAAGG,CAAC;IACV;EACF;EAEA,OAAO;IACLO,OAAO,EAAEA,CAAA,KAAMxB,IAAI,CAACwB,OAAO,CAAC;EAC9B,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}