{"ast":null,"code":"import { ClassicPreset as Classic, NodeEditor } from 'rete';\nimport { Area3DExtensions, Area3DPlugin } from 'rete-area-3d-plugin';\nimport { ConnectionPlugin, Presets as ConnectionPresets } from 'rete-connection-plugin';\nimport { ReactPlugin, Presets as ReactPresets } from 'rete-react-plugin';\nimport { createRoot } from 'react-dom/client';\nimport * as THREE from 'three';\nclass Connection extends Classic.Connection {}\nclass NumberNode extends Classic.Node {\n  constructor(initial, change) {\n    super('Number');\n    this.width = 180;\n    this.height = 120;\n    this.addOutput('value', new Classic.Output(socket, 'Number'));\n    this.addControl('value', new Classic.InputControl('number', {\n      initial,\n      change\n    }));\n  }\n}\nclass AddNode extends Classic.Node {\n  constructor() {\n    super('Add');\n    this.width = 180;\n    this.height = 195;\n    this.addInput('a', new Classic.Input(socket, 'A'));\n    this.addInput('b', new Classic.Input(socket, 'B'));\n    this.addOutput('value', new Classic.Output(socket, 'Number'));\n    this.addControl('result', new Classic.InputControl('number', {\n      initial: 0,\n      readonly: true\n    }));\n  }\n}\nconst socket = new Classic.Socket('socket');\nexport async function createEditor(container) {\n  const editor = new NodeEditor();\n  const area = new Area3DPlugin(container);\n  const connection = new ConnectionPlugin();\n  const reactRender = new ReactPlugin({\n    createRoot\n  });\n  editor.use(area);\n  area.use(reactRender);\n  area.use(connection);\n  connection.addPreset(ConnectionPresets.classic.setup());\n  reactRender.addPreset(ReactPresets.classic.setup());\n  Area3DExtensions.forms.connection(reactRender);\n  Area3DExtensions.forms.node(area);\n  const a = new NumberNode(1);\n  const b = new NumberNode(1);\n  const add = new AddNode();\n  await editor.addNode(a);\n  await editor.addNode(b);\n  await editor.addNode(add);\n  await editor.addConnection(new Connection(a, 'value', add, 'a'));\n  await editor.addConnection(new Connection(b, 'value', add, 'b'));\n  await area.translate(a.id, {\n    x: 12,\n    y: 35\n  });\n  await area.translate(b.id, {\n    x: 12,\n    y: 172\n  });\n  await area.translate(add.id, {\n    x: 250,\n    y: 12\n  });\n  const axesHelper = new THREE.AxesHelper(100);\n  const gridHelper = new THREE.GridHelper(10000, 100);\n  gridHelper.translateY(-320);\n  area.area.scene.root.add(axesHelper);\n  area.area.scene.root.add(gridHelper);\n  Area3DExtensions.animate(area);\n  return {\n    destroy: () => area.destroy()\n  };\n}","map":{"version":3,"names":["ClassicPreset","Classic","NodeEditor","Area3DExtensions","Area3DPlugin","ConnectionPlugin","Presets","ConnectionPresets","ReactPlugin","ReactPresets","createRoot","THREE","Connection","NumberNode","Node","constructor","initial","change","width","height","addOutput","Output","socket","addControl","InputControl","AddNode","addInput","Input","readonly","Socket","createEditor","container","editor","area","connection","reactRender","use","addPreset","classic","setup","forms","node","a","b","add","addNode","addConnection","translate","id","x","y","axesHelper","AxesHelper","gridHelper","GridHelper","translateY","scene","root","animate","destroy"],"sources":["/Users/jolu/Documents/code/jira-node-editor/src/rete/3d.ts"],"sourcesContent":["import { ClassicPreset as Classic, GetSchemes, NodeEditor } from 'rete';\n\nimport { Area3D, Area3DExtensions, Area3DPlugin } from 'rete-area-3d-plugin';\nimport {\n  ConnectionPlugin,\n  Presets as ConnectionPresets,\n} from 'rete-connection-plugin';\nimport {\n  ReactPlugin,\n  ReactArea2D,\n  Presets as ReactPresets,\n} from 'rete-react-plugin';\nimport { createRoot } from 'react-dom/client';\n\nimport * as THREE from 'three';\n\ntype Node = NumberNode | AddNode;\ntype Conn =\n  | Connection<NumberNode, AddNode>\n  | Connection<AddNode, AddNode>\n  | Connection<AddNode, NumberNode>;\ntype Schemes = GetSchemes<Node, Conn>;\n\nclass Connection<A extends Node, B extends Node> extends Classic.Connection<\n  A,\n  B\n> {}\n\nclass NumberNode extends Classic.Node {\n  width = 180;\n  height = 120;\n\n  constructor(initial: number, change?: (value: number) => void) {\n    super('Number');\n\n    this.addOutput('value', new Classic.Output(socket, 'Number'));\n    this.addControl(\n      'value',\n      new Classic.InputControl('number', { initial, change })\n    );\n  }\n}\n\nclass AddNode extends Classic.Node {\n  width = 180;\n  height = 195;\n\n  constructor() {\n    super('Add');\n\n    this.addInput('a', new Classic.Input(socket, 'A'));\n    this.addInput('b', new Classic.Input(socket, 'B'));\n    this.addOutput('value', new Classic.Output(socket, 'Number'));\n    this.addControl(\n      'result',\n      new Classic.InputControl('number', { initial: 0, readonly: true })\n    );\n  }\n}\n\ntype AreaExtra = Area3D<Schemes> | ReactArea2D<Schemes>;\n\nconst socket = new Classic.Socket('socket');\n\nexport async function createEditor(container: HTMLElement) {\n  const editor = new NodeEditor<Schemes>();\n  const area = new Area3DPlugin<Schemes, AreaExtra>(container);\n  const connection = new ConnectionPlugin<Schemes, AreaExtra>();\n  const reactRender = new ReactPlugin<Schemes, AreaExtra>({ createRoot });\n\n  editor.use(area);\n  area.use(reactRender);\n\n  area.use(connection);\n\n  connection.addPreset(ConnectionPresets.classic.setup());\n  reactRender.addPreset(ReactPresets.classic.setup());\n\n  Area3DExtensions.forms.connection(reactRender);\n\n  Area3DExtensions.forms.node(area);\n\n  const a = new NumberNode(1);\n  const b = new NumberNode(1);\n  const add = new AddNode();\n\n  await editor.addNode(a);\n  await editor.addNode(b);\n  await editor.addNode(add);\n\n  await editor.addConnection(new Connection(a, 'value', add, 'a'));\n  await editor.addConnection(new Connection(b, 'value', add, 'b'));\n\n  await area.translate(a.id, { x: 12, y: 35 });\n  await area.translate(b.id, { x: 12, y: 172 });\n  await area.translate(add.id, { x: 250, y: 12 });\n\n  const axesHelper = new THREE.AxesHelper(100);\n  const gridHelper = new THREE.GridHelper(10000, 100);\n\n  gridHelper.translateY(-320);\n\n  area.area.scene.root.add(axesHelper);\n  area.area.scene.root.add(gridHelper);\n\n  Area3DExtensions.animate(area);\n\n  return {\n    destroy: () => area.destroy(),\n  };\n}\n"],"mappings":"AAAA,SAASA,aAAa,IAAIC,OAAO,EAAcC,UAAU,QAAQ,MAAM;AAEvE,SAAiBC,gBAAgB,EAAEC,YAAY,QAAQ,qBAAqB;AAC5E,SACEC,gBAAgB,EAChBC,OAAO,IAAIC,iBAAiB,QACvB,wBAAwB;AAC/B,SACEC,WAAW,EAEXF,OAAO,IAAIG,YAAY,QAClB,mBAAmB;AAC1B,SAASC,UAAU,QAAQ,kBAAkB;AAE7C,OAAO,KAAKC,KAAK,MAAM,OAAO;AAS9B,MAAMC,UAAU,SAAyCX,OAAO,CAACW,UAAU,CAGzE;AAEF,MAAMC,UAAU,SAASZ,OAAO,CAACa,IAAI,CAAC;EAIpCC,WAAWA,CAACC,OAAe,EAAEC,MAAgC,EAAE;IAC7D,KAAK,CAAC,QAAQ,CAAC;IAAC,KAJlBC,KAAK,GAAG,GAAG;IAAA,KACXC,MAAM,GAAG,GAAG;IAKV,IAAI,CAACC,SAAS,CAAC,OAAO,EAAE,IAAInB,OAAO,CAACoB,MAAM,CAACC,MAAM,EAAE,QAAQ,CAAC,CAAC;IAC7D,IAAI,CAACC,UAAU,CACb,OAAO,EACP,IAAItB,OAAO,CAACuB,YAAY,CAAC,QAAQ,EAAE;MAAER,OAAO;MAAEC;IAAO,CAAC,CACxD,CAAC;EACH;AACF;AAEA,MAAMQ,OAAO,SAASxB,OAAO,CAACa,IAAI,CAAC;EAIjCC,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,KAAK,CAAC;IAAC,KAJfG,KAAK,GAAG,GAAG;IAAA,KACXC,MAAM,GAAG,GAAG;IAKV,IAAI,CAACO,QAAQ,CAAC,GAAG,EAAE,IAAIzB,OAAO,CAAC0B,KAAK,CAACL,MAAM,EAAE,GAAG,CAAC,CAAC;IAClD,IAAI,CAACI,QAAQ,CAAC,GAAG,EAAE,IAAIzB,OAAO,CAAC0B,KAAK,CAACL,MAAM,EAAE,GAAG,CAAC,CAAC;IAClD,IAAI,CAACF,SAAS,CAAC,OAAO,EAAE,IAAInB,OAAO,CAACoB,MAAM,CAACC,MAAM,EAAE,QAAQ,CAAC,CAAC;IAC7D,IAAI,CAACC,UAAU,CACb,QAAQ,EACR,IAAItB,OAAO,CAACuB,YAAY,CAAC,QAAQ,EAAE;MAAER,OAAO,EAAE,CAAC;MAAEY,QAAQ,EAAE;IAAK,CAAC,CACnE,CAAC;EACH;AACF;AAIA,MAAMN,MAAM,GAAG,IAAIrB,OAAO,CAAC4B,MAAM,CAAC,QAAQ,CAAC;AAE3C,OAAO,eAAeC,YAAYA,CAACC,SAAsB,EAAE;EACzD,MAAMC,MAAM,GAAG,IAAI9B,UAAU,CAAU,CAAC;EACxC,MAAM+B,IAAI,GAAG,IAAI7B,YAAY,CAAqB2B,SAAS,CAAC;EAC5D,MAAMG,UAAU,GAAG,IAAI7B,gBAAgB,CAAqB,CAAC;EAC7D,MAAM8B,WAAW,GAAG,IAAI3B,WAAW,CAAqB;IAAEE;EAAW,CAAC,CAAC;EAEvEsB,MAAM,CAACI,GAAG,CAACH,IAAI,CAAC;EAChBA,IAAI,CAACG,GAAG,CAACD,WAAW,CAAC;EAErBF,IAAI,CAACG,GAAG,CAACF,UAAU,CAAC;EAEpBA,UAAU,CAACG,SAAS,CAAC9B,iBAAiB,CAAC+B,OAAO,CAACC,KAAK,CAAC,CAAC,CAAC;EACvDJ,WAAW,CAACE,SAAS,CAAC5B,YAAY,CAAC6B,OAAO,CAACC,KAAK,CAAC,CAAC,CAAC;EAEnDpC,gBAAgB,CAACqC,KAAK,CAACN,UAAU,CAACC,WAAW,CAAC;EAE9ChC,gBAAgB,CAACqC,KAAK,CAACC,IAAI,CAACR,IAAI,CAAC;EAEjC,MAAMS,CAAC,GAAG,IAAI7B,UAAU,CAAC,CAAC,CAAC;EAC3B,MAAM8B,CAAC,GAAG,IAAI9B,UAAU,CAAC,CAAC,CAAC;EAC3B,MAAM+B,GAAG,GAAG,IAAInB,OAAO,CAAC,CAAC;EAEzB,MAAMO,MAAM,CAACa,OAAO,CAACH,CAAC,CAAC;EACvB,MAAMV,MAAM,CAACa,OAAO,CAACF,CAAC,CAAC;EACvB,MAAMX,MAAM,CAACa,OAAO,CAACD,GAAG,CAAC;EAEzB,MAAMZ,MAAM,CAACc,aAAa,CAAC,IAAIlC,UAAU,CAAC8B,CAAC,EAAE,OAAO,EAAEE,GAAG,EAAE,GAAG,CAAC,CAAC;EAChE,MAAMZ,MAAM,CAACc,aAAa,CAAC,IAAIlC,UAAU,CAAC+B,CAAC,EAAE,OAAO,EAAEC,GAAG,EAAE,GAAG,CAAC,CAAC;EAEhE,MAAMX,IAAI,CAACc,SAAS,CAACL,CAAC,CAACM,EAAE,EAAE;IAAEC,CAAC,EAAE,EAAE;IAAEC,CAAC,EAAE;EAAG,CAAC,CAAC;EAC5C,MAAMjB,IAAI,CAACc,SAAS,CAACJ,CAAC,CAACK,EAAE,EAAE;IAAEC,CAAC,EAAE,EAAE;IAAEC,CAAC,EAAE;EAAI,CAAC,CAAC;EAC7C,MAAMjB,IAAI,CAACc,SAAS,CAACH,GAAG,CAACI,EAAE,EAAE;IAAEC,CAAC,EAAE,GAAG;IAAEC,CAAC,EAAE;EAAG,CAAC,CAAC;EAE/C,MAAMC,UAAU,GAAG,IAAIxC,KAAK,CAACyC,UAAU,CAAC,GAAG,CAAC;EAC5C,MAAMC,UAAU,GAAG,IAAI1C,KAAK,CAAC2C,UAAU,CAAC,KAAK,EAAE,GAAG,CAAC;EAEnDD,UAAU,CAACE,UAAU,CAAC,CAAC,GAAG,CAAC;EAE3BtB,IAAI,CAACA,IAAI,CAACuB,KAAK,CAACC,IAAI,CAACb,GAAG,CAACO,UAAU,CAAC;EACpClB,IAAI,CAACA,IAAI,CAACuB,KAAK,CAACC,IAAI,CAACb,GAAG,CAACS,UAAU,CAAC;EAEpClD,gBAAgB,CAACuD,OAAO,CAACzB,IAAI,CAAC;EAE9B,OAAO;IACL0B,OAAO,EAAEA,CAAA,KAAM1B,IAAI,CAAC0B,OAAO,CAAC;EAC9B,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}